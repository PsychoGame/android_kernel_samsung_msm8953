--- original/include/asm-generic/pgtable.h	2020-05-07 08:31:26.764778441 +0200
+++ changed/include/asm-generic/pgtable.h	2019-06-03 13:39:53.000000000 +0200
@@ -150,6 +150,19 @@ static inline void ptep_set_wrprotect(st
 }
 #endif
 
+#ifdef CONFIG_TIMA_LKMAUTH
+#ifdef CONFIG_TIMA_LKMAUTH_CODE_PROT
+
+static inline void ptep_set_nxprotect(struct mm_struct *mm, unsigned long address, pte_t *ptep)
+{
+	pte_t old_pte = *ptep;
+	set_pte_at(mm, address, ptep, pte_mknexec(old_pte));
+	return;
+}
+
+#endif
+#endif
+
 #ifndef __HAVE_ARCH_PMDP_SET_WRPROTECT
 #ifdef CONFIG_TRANSPARENT_HUGEPAGE
 static inline void pmdp_set_wrprotect(struct mm_struct *mm,
