--- original/include/linux/swap.h	2020-05-07 08:31:27.064775742 +0200
+++ changed/include/linux/swap.h	2019-06-03 13:39:53.000000000 +0200
@@ -364,8 +364,15 @@ extern void check_move_unevictable_pages
 
 extern int kswapd_run(int nid);
 extern void kswapd_stop(int nid);
-#ifdef CONFIG_MEMCG
-extern int mem_cgroup_swappiness(struct mem_cgroup *mem);
+#if defined(CONFIG_MEMCG) && !(CONFIG_MEMCG_FORCE_USE_VM_SWAPPINESS)
+static inline int mem_cgroup_swappiness(struct mem_cgroup *memcg)
+{
+	/* root ? */
+	if (mem_cgroup_disabled() || !memcg->css.parent)
+		return vm_swappiness;
+
+	return memcg->swappiness;
+}
 #else
 static inline int mem_cgroup_swappiness(struct mem_cgroup *mem)
 {
