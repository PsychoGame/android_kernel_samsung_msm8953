--- original/drivers/hid/usbhid/hiddev.c	2020-05-07 08:06:11.641287836 +0200
+++ changed/drivers/hid/usbhid/hiddev.c	2019-06-03 13:39:50.000000000 +0200
@@ -510,19 +510,18 @@ static noinline int hiddev_ioctl_usage(s
 				goto inval;
 
 			field = report->field[uref->field_index];
-		}
 
-		if (cmd == HIDIOCGCOLLECTIONINDEX) {
-			if (uref->usage_index >= field->maxusage)
+			if (cmd == HIDIOCGCOLLECTIONINDEX) {
+				if (uref->usage_index >= field->maxusage)
+					goto inval;
+			} else if (uref->usage_index >= field->report_count)
 				goto inval;
-		} else if (uref->usage_index >= field->report_count)
-			goto inval;
-
-		else if ((cmd == HIDIOCGUSAGES || cmd == HIDIOCSUSAGES) &&
+		}
+		
+		if ((cmd == HIDIOCGUSAGES || cmd == HIDIOCSUSAGES) &&
 			 (uref_multi->num_values > HID_MAX_MULTI_USAGES ||
-			uref->usage_index + uref_multi->num_values >
-			field->report_count))
-			goto inval;
+			  uref->usage_index + uref_multi->num_values > field->report_count))
+				goto inval;
 
 		switch (cmd) {
 		case HIDIOCGUSAGE:
